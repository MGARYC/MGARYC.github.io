<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.mgary.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="路其修远兮，吾将上下而求索">
<meta property="og:type" content="website">
<meta property="og:title" content="CodingDiary">
<meta property="og:url" content="http://blog.mgary.top/page/2/index.html">
<meta property="og:site_name" content="CodingDiary">
<meta property="og:description" content="路其修远兮，吾将上下而求索">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="MAGRY">
<meta property="article:tag" content="java,SpringClude,SpringBoot,Mysql,Linux,Docker">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.mgary.top/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>CodingDiary</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">CodingDiary</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">CodingDiary-代码日记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Docker-%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Docker-%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/" class="post-title-link" itemprop="url">Docker-远程连接</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:06:49" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /lib/systemd/system/docker.service</span><br><span class="line">修改</span><br><span class="line">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock</span><br></pre></td></tr></table></figure>
<h2 id="Docker-服务-TLS-证书全自动生成"><a href="#Docker-服务-TLS-证书全自动生成" class="headerlink" title="Docker 服务 TLS 证书全自动生成"></a>Docker 服务 TLS 证书全自动生成</h2><h2 id="转载https-segmentfault-com-a-1190000018530483"><a href="#转载https-segmentfault-com-a-1190000018530483" class="headerlink" title="转载https://segmentfault.com/a/1190000018530483"></a>转载<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018530483">https://segmentfault.com/a/1190000018530483</a></h2><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li>客户端用的key保存到~/.docker/tls-client-certs.tar.gz</li>
<li>需要使用openssl 命令因此需要配置文件输出地址</li>
</ul>
<h3 id="centos7-3地址修改"><a href="#centos7-3地址修改" class="headerlink" title="centos7.3地址修改"></a>centos7.3地址修改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> vim  /etc/pki/tls/openssl.cnf</span><br><span class="line">//修改位置</span><br><span class="line">[ CA_default ]</span><br><span class="line">dir             = /etc/docker/openssl</span><br></pre></td></tr></table></figure>


<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Created by L.STONE &lt;web.developer.network@gmail.com&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Mod By Ryan.L &lt;github-benzBrake@woai.ru&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -------------------------------------------------------------</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 自动创建 Docker TLS 证书</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -------------------------------------------------------------</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以下是配置信息</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Config start</span></span><br><span class="line">IP=&quot;8.8.8.8&quot;</span><br><span class="line">PASSWORD=&quot;123456&quot;</span><br><span class="line">COUNTRY=&quot;CN&quot;</span><br><span class="line">STATE=&quot;Beijing&quot;</span><br><span class="line">CITY=&quot;&quot;</span><br><span class="line">ORGANIZATION=&quot;iPlayLoli&quot;</span><br><span class="line">ORGANIZATIONAL_UNIT=&quot;Dev&quot;</span><br><span class="line">COMMON_NAME=&quot;$IP&quot;</span><br><span class="line">EMAIL=&quot;github-benzBrake@woai.ru&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Config end</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 工作目录</span></span><br><span class="line">mkdir -p /etc/docker ~/.docker</span><br><span class="line">cd ~/.docker</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止 docker</span></span><br><span class="line">service docker stop</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成 CA 密钥</span></span><br><span class="line">if [[ ! -f ca-key.pem ]]; then</span><br><span class="line">    echo &quot; - 生成 CA 密钥&quot;</span><br><span class="line">    openssl genrsa -aes256 -passout &quot;pass:$PASSWORD&quot; -out &quot;ca-key.pem&quot; 4096</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成 CA</span></span><br><span class="line">if [[ ! -f ca.pem ]]; then</span><br><span class="line">    echo &quot; - 生成 CA&quot;</span><br><span class="line">    openssl req -new -x509 -days 365 -key &quot;ca-key.pem&quot; -sha256 -out &quot;ca.pem&quot; -passin &quot;pass:$PASSWORD&quot; -subj &quot;/C=$COUNTRY/ST=$STATE/L=$CITY/O=$ORGANIZATION/OU=$ORGANIZATIONAL_UNIT/CN=$COMMON_NAME/emailAddress=$EMAIL&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成服务器密钥 &amp; 服务器证书</span></span><br><span class="line">if [[ ! -f server-key.pem ]]; then</span><br><span class="line">    echo &quot; - 生成服务器密钥&quot;</span><br><span class="line">    openssl genrsa -out &quot;server-key.pem&quot; 4096</span><br><span class="line">fi</span><br><span class="line">if [[ ! -f server.csr ]]; then</span><br><span class="line">     openssl req -subj &quot;/CN=$COMMON_NAME&quot; -sha256 -new -key &quot;server-key.pem&quot; -out server.csr</span><br><span class="line">fi</span><br><span class="line">if [[ ! -f server-cert.pem ]]; then</span><br><span class="line">    echo &quot; - 生成服务器证书&quot;</span><br><span class="line">    echo &quot;subjectAltName = IP:$IP,IP:127.0.0.1&quot; &gt;&gt; extfile.cnf</span><br><span class="line">    echo &quot;extendedKeyUsage = serverAuth&quot; &gt;&gt; extfile.cnf</span><br><span class="line">    openssl x509 -req -days 365 -sha256 -in server.csr -passin &quot;pass:$PASSWORD&quot; -CA &quot;ca.pem&quot; -CAkey &quot;ca-key.pem&quot; -CAcreateserial -out &quot;server-cert.pem&quot; -extfile extfile.cnf</span><br><span class="line">fi</span><br><span class="line">rm -f extfile.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成客户端证书</span></span><br><span class="line">if [[ ! -f key.pem ]]; then</span><br><span class="line">    openssl genrsa -out &quot;key.pem&quot; 4096</span><br><span class="line">fi</span><br><span class="line">if [[ ! -f cert.pem ]]; then</span><br><span class="line">    openssl req -subj &#x27;/CN=client&#x27; -new -key &quot;key.pem&quot; -out client.csr</span><br><span class="line">    echo extendedKeyUsage = clientAuth &gt;&gt; extfile.cnf</span><br><span class="line">    openssl x509 -req -days 365 -sha256 -in client.csr -passin &quot;pass:$PASSWORD&quot; -CA &quot;ca.pem&quot; -CAkey &quot;ca-key.pem&quot; -CAcreateserial -out &quot;cert.pem&quot; -extfile extfile.cnf</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">chmod -v 0400 &quot;ca-key.pem&quot; &quot;key.pem&quot; &quot;server-key.pem&quot;</span><br><span class="line">chmod -v 0444 &quot;ca.pem&quot; &quot;server-cert.pem&quot; &quot;cert.pem&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 打包客户端证书</span></span><br><span class="line">echo &quot; - 打包客户端证书为 tls-client-certs.tar.gz&quot;</span><br><span class="line">mkdir -p &quot;tls-client-certs&quot;</span><br><span class="line">cp -f &quot;ca.pem&quot; &quot;cert.pem&quot; &quot;key.pem&quot; &quot;tls-client-certs/&quot;</span><br><span class="line">cd &quot;tls-client-certs&quot;</span><br><span class="line">tar zcf &quot;tls-client-certs.tar.gz&quot; *</span><br><span class="line">mv &quot;tls-client-certs.tar.gz&quot; ../</span><br><span class="line">cd ..</span><br><span class="line">rm -rf &quot;tls-client-certs&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拷贝服务端证书</span></span><br><span class="line">mkdir -p /etc/docker/certs.d</span><br><span class="line">cp -f &quot;ca.pem&quot; &quot;server-cert.pem&quot; &quot;server-key.pem&quot; /etc/docker/certs.d/</span><br><span class="line">echo &quot; - 修改 /etc/docker/daemon.json 文件&quot;</span><br><span class="line">if [[ -f /etc/docker/daemon.json ]]; then</span><br><span class="line">    grep &quot;/etc/docker/certs.d/server-key.pem&quot; /etc/docker/daemon.json &gt; /dev/null</span><br><span class="line">    if [[ ! $? -eq 0 ]]; then</span><br><span class="line">        cat &gt;/etc/docker/daemon.json&lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">  &quot;tlsverify&quot;: true,</span><br><span class="line">  &quot;tlscacert&quot;: &quot;/etc/docker/certs.d/ca.pem&quot;,</span><br><span class="line">  &quot;tlscert&quot;: &quot;/etc/docker/certs.d/server-cert.pem&quot;,</span><br><span class="line">  &quot;tlskey&quot;: &quot;/etc/docker/certs.d/server-key.pem&quot;,</span><br><span class="line">  &quot;hosts&quot;: [&quot;tcp://0.0.0.0:2376&quot;, &quot;unix:///var/run/docker.sock&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">    fi</span><br><span class="line">else</span><br><span class="line">    cat &gt;/etc/docker/daemon.json&lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">  &quot;tlsverify&quot;: true,</span><br><span class="line">  &quot;tlscacert&quot;: &quot;/etc/docker/certs.d/ca.pem&quot;,</span><br><span class="line">  &quot;tlscert&quot;: &quot;/etc/docker/certs.d/server-cert.pem&quot;,</span><br><span class="line">  &quot;tlskey&quot;: &quot;/etc/docker/certs.d/server-key.pem&quot;,</span><br><span class="line">  &quot;hosts&quot;: [&quot;tcp://0.0.0.0:2376&quot;, &quot;unix:///var/run/docker.sock&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 覆盖启动参数，解决 docker 启动失败</span></span><br><span class="line">if [[ ! -z $(command -v systemctl) ]];then</span><br><span class="line">    mkdir -p /etc/systemd/system/docker.service.d</span><br><span class="line">    if [[ ! -f /etc/systemd/system/docker.service.d/override.conf ]]; then</span><br><span class="line">        cat &gt;/etc/systemd/system/docker.service.d/override.conf&lt;&lt;EOF</span><br><span class="line">[Service]</span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=/usr/bin/dockerd</span><br><span class="line">EOF</span><br><span class="line">    systemctl daemon-reload</span><br><span class="line">    fi</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清理</span></span><br><span class="line">rm -vf client.csr server.csr extfile.cnf ca.srl server-cert.pem server-key.pem cert.pem</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动 docker</span></span><br><span class="line">service docker start</span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端远程连接</span></span><br><span class="line">echo &quot;Connect to server via docker-cli:&quot;</span><br><span class="line">echo &quot;docker -H $IP:2376 --tlsverify --tlscacert ~/.docker/ca.pem --tlscert ~/.docker/cert.pem --tlskey ~/.docker/key.pem ps -a&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端使用 cURL 连接</span></span><br><span class="line">echo &quot;Connect to server via curl:&quot;</span><br><span class="line">echo &quot;curl --cacert ~/.docker/ca.pem --cert ~/.docker/cert.pem --key ~/.docker/key.pem https://$IP:2376/containers/json&quot;</span><br><span class="line"></span><br><span class="line">echo -e &quot;\e[1;32mAll be done.\e[0m&quot;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/IDEA-%E5%BF%AB%E6%8D%B7%E9%94%AE%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/IDEA-%E5%BF%AB%E6%8D%B7%E9%94%AE%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">IDEA-快捷键使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:08:45" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="磨刀不误砍柴工，这些快捷键能加快编码数据，希望大家收藏一波"><a href="#磨刀不误砍柴工，这些快捷键能加快编码数据，希望大家收藏一波" class="headerlink" title="磨刀不误砍柴工，这些快捷键能加快编码数据，希望大家收藏一波"></a>磨刀不误砍柴工，这些快捷键能加快编码数据，希望大家收藏一波</h1><p>Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/<em>…</em>/ ）<br>Ctrl+D 复制行<br>Ctrl+X 删除行<br>快速修复 alt+enter (modify/cast)<br>代码提示 alt+/<br>ctr+G 定位某一行<br>Shift+F6 重构-重命名<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本</p>
<p>Ctrl+E 最近打开的文件<br>Ctrl+J 自动代码</p>
<p>组织导入 ctr+alt+O<br>格式化代码 ctr+alt+L<br>大小写转化 ctr+shift+U</p>
<hr>
<h2 id="IntelliJ-Idea-常用快捷键列表"><a href="#IntelliJ-Idea-常用快捷键列表" class="headerlink" title="IntelliJ Idea 常用快捷键列表"></a>IntelliJ Idea 常用快捷键列表</h2><p>Alt+回车 导入包,自动修正<br>Ctrl+N   查找类<br>Ctrl+Shift+N 查找文件<br>Ctrl+Alt+L  格式化代码<br>Ctrl+Alt+O 优化导入的类和包<br>Alt+Insert 生成代码(如get,set方法,构造函数等)<br>Ctrl+E或者Alt+Shift+C  最近更改的代码<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本<br>Ctrl+Shift+Space 自动补全代码<br>Ctrl+空格 代码提示<br>Ctrl+Alt+Space 类名或接口名提示<br>Ctrl+P 方法参数提示<br>Ctrl+Shift+Alt+N 查找类中的方法或变量<br>Alt+Shift+C 对比最近修改的代码</p>
<p>Shift+F6  重构-重命名<br>Ctrl+Shift+先上键<br>Ctrl+X 删除行<br>Ctrl+D 复制行<br>Ctrl+/ 或 Ctrl+Shift+/  注释（// 或者/<em>…</em>/ ）<br>Ctrl+J  自动代码<br>Ctrl+E 最近打开的文件<br>Ctrl+H 显示类结构图<br>Ctrl+Q 显示注释文档<br>Alt+F1 查找代码所在位置<br>Alt+1 快速打开或隐藏工程面板<br>Ctrl+Alt+ left/right 返回至上次浏览的位置<br>Alt+ left/right 切换代码视图<br>Alt+ Up/Down 在方法间快速移动定位<br>Ctrl+Shift+Up/Down 代码向上/下移动。<br>F2 或Shift+F2 高亮错误或警告快速定位</p>
<p>代码标签输入完成后，按Tab，生成代码。<br>选中文本，按Ctrl+Shift+F7 ，高亮显示所有该文本，按Esc高亮消失。<br>Ctrl+W 选中代码，连续按会有其他效果<br>选中文本，按Alt+F3 ，逐个往下查找相同文本，并高亮显示。<br>Ctrl+Up/Down 光标跳转到第一行或最后一行下<br>Ctrl+B 快速打开光标处的类或方法 </p>
<hr>
<h2 id="IDEA内存优化"><a href="#IDEA内存优化" class="headerlink" title="IDEA内存优化"></a>IDEA内存优化</h2><ol>
<li>因机器本身的配置而配置：</li>
</ol>
<h2 id="IntelliJ-IDEA-8-bin-idea-exe-vmoptions"><a href="#IntelliJ-IDEA-8-bin-idea-exe-vmoptions" class="headerlink" title="\IntelliJ IDEA 8\bin\idea.exe.vmoptions  "></a>\IntelliJ IDEA 8\bin\idea.exe.vmoptions  </h2><p>-Xms64m<br>-Xmx256m<br>-XX:MaxPermSize=92m<br>-ea<br>-server<br>-Dsun.awt.keepWorkingSetOnMinimize=true</p>
<hr>
<ol start="2">
<li>查询快捷键</li>
</ol>
<p>CTRL+N   查找类<br>CTRL+SHIFT+N  查找文件<br>CTRL+SHIFT+ALT+N 查找类中的方法或变量<br>CIRL+B   找变量的来源<br>CTRL+ALT+B  找所有的子类<br>CTRL+SHIFT+B  找变量的类<br>CTRL+G   定位行<br>CTRL+F   在当前窗口查找文本<br>CTRL+SHIFT+F  在指定窗口查找文本<br>CTRL+R   在 当前窗口替换文本<br>CTRL+SHIFT+R  在指定窗口替换文本<br>ALT+SHIFT+C  查找修改的文件<br>CTRL+E   最近打开的文件<br>F3   向下查找关键字出现位置<br>SHIFT+F3  向上一个关键字出现位置<br>F4   查找变量来源<br>CTRL+ALT+F7  选中的字符查找工程出现的地方<br>CTRL+SHIFT+O  弹出显示查找内容</p>
<hr>
<ol start="3">
<li>自动代码</li>
</ol>
<p>ALT+回车  导入包,自动修正<br>CTRL+ALT+L  格式化代码<br>CTRL+ALT+I  自动缩进<br>CTRL+ALT+O  优化导入的类和包<br>ALT+INSERT  生成代码(如GET,SET方法,构造函数等)<br>CTRL+E 最近更改的代码<br>CTRL+SHIFT+SPACE 自动补全代码<br>CTRL+空格  代码提示<br>CTRL+ALT+SPACE  类名或接口名提示<br>CTRL+P   方法参数提示<br>CTRL+J   自动代码<br>CTRL+ALT+T  把选中的代码放在 TRY{} IF{} ELSE{} 里</p>
<hr>
<ol start="4">
<li>复制快捷方式</li>
</ol>
<p>CTRL+D   复制行<br>CTRL+X   剪切,删除行  </p>
<hr>
<ol start="5">
<li>其他快捷方式</li>
</ol>
<p>CIRL+U   大小写切换<br>CTRL+Z   倒退<br>CTRL+SHIFT+Z  向前<br>CTRL+ALT+F12  资源管理器打开文件夹<br>ALT+F1   查找文件所在目录位置<br>SHIFT+ALT+INSERT 竖编辑模式<br>CTRL+/   注释//<br>CTRL+SHIFT+/  注释/<em>…</em>/<br>CTRL+W   选中代码，连续按会有其他效果<br>CTRL+B   快速打开光标处的类或方法<br>ALT+ ←/→  切换代码视图<br>CTRL+ALT ←/→  返回上次编辑的位置<br>ALT+ ↑/↓  在方法间快速移动定位<br>SHIFT+F6  重构-重命名<br>CTRL+H   显示类结构图<br>CTRL+Q   显示注释文档<br>ALT+1   快速打开或隐藏工程面板<br>CTRL+SHIFT+UP/DOWN 代码向上/下移动。<br>CTRL+UP/DOWN  光标跳转到第一行或最后一行下<br>ESC   光标返回编辑框<br>SHIFT+ESC  光标返回编辑框,关闭无用的窗口<br>F1   帮助千万别按,很卡!<br>CTRL+F4   非常重要下班都用</p>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Kafka-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Kafka-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">KAFKA学习记录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:33:25" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><h3 id="一、broker"><a href="#一、broker" class="headerlink" title="一、broker"></a>一、broker</h3><blockquote>
<p>一个独立的 Kafka 服务器被称为 broker。</p>
</blockquote>
<h4 id="broker配置"><a href="#broker配置" class="headerlink" title="broker配置"></a>broker配置</h4><blockquote>
<p>Kafka 发行包里自带的配置样本可以用来安装单机服务，但并不能满足大多数安装场景的要求。 Kafka 有很多配置选项，涉及安装和调优的方方面面。不过大多数调优选项可以使用默认配置，除非你对调优有特别的要求。</p>
<blockquote>
<ol>
<li> broker.id<br>每个broker都需要有一个标识符，使用broker.id来表示。它的默认值是0，也可以被设置成其他任意整数。这个值在整个Kafka集群里必须是唯一的。这个值可以任意选定，如果出于维护的需要，可以在服务器节点间交换使用这些ID。建议把它们设置成与机器名具有相关性的整数，这样在进行维护时，将ID号映射到机器名就没那么麻烦了。例如，如果机器名包含唯一性的数字（比如hostl.example.com、host2.example.com），那么用这些数字<br>来设置broker.id就再好不过了。</li>
<li>port<br>如果使用配置样本来启动Kafka，它会监听9092端口。修改po「t配置参数可以把它设置<br>成其他任意可用的端口。要注意，如果使用1024以下的端口，需要使用root权限启动<br>Kafka，不过不建议这么做。<br>zookeeper.connect<br>用于保存broker元数据的Zookeeperd地址是是通过zookeeper.connect来指定的。<br>localhost:2181表示这个Zooke巳per是运行在本地的2181端口上。该配置参数是用冒号分隔的一组localhost:port/path列表，每一部分的含义如下：<blockquote>
<ul>
<li>hostname是Zookeeper服务器的机器名或IP地址;</li>
<li>port是Zookeeper的客户端连接端口;</li>
<li>/path是可选的Zookeeper路径，作为Kafka集群的chroot环境。如果不指定，默认使用根路径。如果指定的chroot路径不存在，broker会在启动的时候创建它。</li>
</ul>
</blockquote>
</li>
</ol>
</blockquote>
</blockquote>
<h3 id="二、集群"><a href="#二、集群" class="headerlink" title="二、集群"></a>二、集群</h3><blockquote>
<p>broker 是集群的组成部分。</p>
</blockquote>
<h3 id="三、生产者-Producer"><a href="#三、生产者-Producer" class="headerlink" title="三、生产者{Producer}"></a>三、生产者{Producer}</h3><blockquote>
<p>创建消息。</p>
</blockquote>
<h3 id="四、消费者"><a href="#四、消费者" class="headerlink" title="四、消费者"></a>四、消费者</h3><blockquote>
<p>消费消息。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Kafka-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Kafka-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">Kafka常见问题解决方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:32:45" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="max-request-size出错-RecordTooLargeException异常"><a href="#max-request-size出错-RecordTooLargeException异常" class="headerlink" title="max-request-size出错;RecordTooLargeException异常"></a>max-request-size出错;RecordTooLargeException异常</h2><ol>
<li><p>Kafka者配置文件 server.properties中添加</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message.max.bytes=100000000（100M）</span><br><span class="line">replica.fetch.max.bytes=100000000（100M）每个分区试图获取的消息字节数。要大于等于message.max.bytes</span><br></pre></td></tr></table></figure></li>
<li><p>生产者配置文件producer.properties中添加</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">max.request.size = 100000000（100M）请求的最大大小为字节。要小于 message.max.bytes</span><br></pre></td></tr></table></figure></li>
<li><p>消费者配置文件consumer.properties中添加</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetch.message.max.bytes=100000000（100M）每个提取请求中为每个主题分区提取的消息字节数。要大于等于message.max.bytes</span><br></pre></td></tr></table></figure></li>
<li><p>Springboot 配置</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kafka:</span><br><span class="line">	bootstrap-servers: localhost:<span class="number">9092</span></span><br><span class="line">	producer:</span><br><span class="line">	properties:</span><br><span class="line">		max.request.size: <span class="number">100000000</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改成功项目生产者启动答应打印</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ProducerConfig values: </span><br><span class="line">	acks = 1</span><br><span class="line">	batch.size = 100000000</span><br><span class="line">	bootstrap.servers = [127.0.0.1:9092]</span><br><span class="line">	buffer.memory = 100000000</span><br><span class="line">	client.id = </span><br><span class="line">	compression.type = none</span><br><span class="line">	connections.max.idle.ms = 540000</span><br><span class="line">	enable.idempotence = false</span><br><span class="line">	interceptor.classes = null</span><br><span class="line">	key.serializer = class org.apache.kafka.common.serialization.StringSerializer</span><br><span class="line">	linger.ms = 0</span><br><span class="line">	max.block.ms = 60000</span><br><span class="line">	max.in.flight.requests.per.connection = 5</span><br><span class="line">	max.request.size = 100000000</span><br><span class="line">	metadata.max.age.ms = 300000</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Redis-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Redis-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Redis-学习总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:33:25" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Redis-学习总结"><a href="#Redis-学习总结" class="headerlink" title="Redis-学习总结"></a>Redis-学习总结</h2><h1 id="基础学习"><a href="#基础学习" class="headerlink" title="基础学习"></a>基础学习</h1><h2 id="Redis的数据类型"><a href="#Redis的数据类型" class="headerlink" title="Redis的数据类型"></a>Redis的数据类型</h2><p>使用场景：</p>
<ol>
<li>制作永久缓存</li>
<li>定时缓存（设值时添加时间搓）</li>
</ol>
<h3 id="String（字符串类型）"><a href="#String（字符串类型）" class="headerlink" title="String（字符串类型）"></a>String（字符串类型）</h3><blockquote>
<p> string 是 redis 最基本的类型，你可以理解成与 Memcached 一模一样的类型，一个 key 对应一个 value。<br>string 类型是二进制安全的。意思是 redis 的 string 可以包含任何数据。比如jpg图片或者序列化的对象。<br>string 类型是 Redis 最基本的数据类型，string 类型的值最大能存储 512MB。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//添加 name = runoob</span><br><span class="line">redis 127.0.0.1:6379&gt; SET name &quot;runoob&quot;</span><br><span class="line">查询name</span><br><span class="line">redis 127.0.0.1:6379&gt; GET name</span><br></pre></td></tr></table></figure>
<h3 id="Hash（哈希）"><a href="#Hash（哈希）" class="headerlink" title="Hash（哈希）"></a>Hash（哈希）</h3><blockquote>
<p>Redis hash 是一个键值(key=&gt;value)对集合。<br>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//设置添加hmset key value.</span><br><span class="line">redis&gt; HMSET myhash field1 &quot;Hello&quot; field2 &quot;World&quot;</span><br><span class="line">//查询、获取Hhget</span><br><span class="line">redis&gt; HGET myhash field1</span><br><span class="line">redis&gt; HGET myhash field2</span><br></pre></td></tr></table></figure>
<h3 id="List（列表）"><a href="#List（列表）" class="headerlink" title="List（列表）"></a>List（列表）</h3><blockquote>
<p>Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。<br>注意：左右都可操作数据。与kafka配合使用(左进右出)</p>
</blockquote>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; lpush runoob redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush runoob mongodb</span><br><span class="line">(integer) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush runoob rabitmq</span><br><span class="line">(integer) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange runoob 0 10</span><br><span class="line">1) &quot;rabitmq&quot;</span><br><span class="line">2) &quot;mongodb&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br></pre></td></tr></table></figure>
<h3 id="Set（集合）"><a href="#Set（集合）" class="headerlink" title="Set（集合）"></a>Set（集合）</h3><blockquote>
<p>Redis的Set是string类型的无序集合。<br>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p>
</blockquote>
<h4 id="sadd-命令"><a href="#sadd-命令" class="headerlink" title="sadd 命令"></a>sadd 命令</h4><blockquote>
<p>添加一个 string 元素到 key 对应的 set 集合中，成功返回1，如果元素已经在集合中返回 0，如果 key 对应的 set 不存在则返回错误。</p>
</blockquote>
<p><code>sadd key member</code></p>
<p>注意：以上实例中 rabitmq 添加了两次，但根据集合内元素的唯一性，第二次插入的元素将被忽略。<br>集合中最大的成员数为 232 - 1(4294967295, 每个集合可存储40多亿个成员)。</p>
<h3 id="zset-sorted-set：有序集合"><a href="#zset-sorted-set：有序集合" class="headerlink" title="zset(sorted set：有序集合)"></a>zset(sorted set：有序集合)</h3><blockquote>
<p>Redis zset 和 set 一样也是string类型元素的集合,且不允许重复的成员。<br>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。<br>zset的成员是唯一的,但分数(score)却可以重复。</p>
</blockquote>
<p><code>zadd key score member</code></p>
<h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 rabitmq</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 rabitmq</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; &gt; ZRANGEBYSCORE runoob 0 1000</span><br><span class="line">1) &quot;mongodb&quot;</span><br><span class="line">2) &quot;rabitmq&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br></pre></td></tr></table></figure>
<h2 id="使用方向应用场景"><a href="#使用方向应用场景" class="headerlink" title="使用方向应用场景"></a>使用方向应用场景</h2><ol>
<li>数据库主从（相当于MySQL集群）</li>
<li>管理网路会话（session和Cookie）<br><a target="_blank" rel="noopener" href="http://www.runoob.com/redis/redis-data-types.html">详情查看</a>…<h1 id="出错解决"><a href="#出错解决" class="headerlink" title="出错解决"></a>出错解决</h1><h2 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h2><blockquote>
<p>原因</p>
<blockquote>
<p>同一时间发出上百万条操作时产生（表现对外无法访问，对内处理数据）</p>
</blockquote>
<p>处理方法</p>
<blockquote>
<p> 加入随机数（降低同一时间数据量的处理）Eg:分成10批没批处理多少等等</p>
</blockquote>
</blockquote>
<h2 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h2><blockquote>
<p>原因</p>
<blockquote>
<p>在访问缓存时,娶不到设置的缓存值，这个请求会直接请求数据库，导致服务能力降低（如果数据量太大会使数据库直接崩溃）</p>
</blockquote>
<p>处理方法</p>
<blockquote>
<p>请求时设置假值，大传入的数据直接通过（常量）传输回去</p>
</blockquote>
</blockquote>
</li>
</ol>
<h1 id="Redis运维"><a href="#Redis运维" class="headerlink" title="Redis运维"></a>Redis运维</h1><h2 id="设置密码"><a href="#设置密码" class="headerlink" title="设置密码"></a>设置密码</h2><ol>
<li>初始化Redis密码：</li>
</ol>
<p>编辑redis.conf配置文件，找到requirepass参数，这个就是配置redis访问密码的参数:</p>
<p>   <code># requirepass foobared</code>  </p>
<pre><code>去掉注释修改为 ` requirepass redis123 `
</code></pre>
<p>   （Ps:需重启Redis才能生效）</p>
<p>   redis的查询速度是非常快的，外部用户一秒内可以尝试多大150K个密码；所以密码要尽量长（对于DBA 没有必要必须记住密码）；</p>
<ol start="2">
<li>不重启Redis设置密码（临时的，当服务器重启了密码必须重设）： </li>
</ol>
<p>设置密码<br><code>config set requirepass test123 </code></p>
<p>查看密码<br><code>config get requirepass</code></p>
<p>在配置文件中有配置requirepass的密码（当redis重启时密码依然有效）。</p>
<ol start="3">
<li>登陆有密码的Redis：</li>
</ol>
<p>  在登录的时候的时候输入密码：</p>
<p>  <code> redis-cli -p 6379 -a test123</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Redis-%E9%9B%86%E7%BE%A4(%E4%B8%80)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Redis-%E9%9B%86%E7%BE%A4(%E4%B8%80)/" class="post-title-link" itemprop="url">Redis-集群(一)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:34:14" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p><a target="_blank" rel="noopener" href="http://www.redis.cn/topics/cluster-tutorial.html">本文提取至官网文档</a></p>
</blockquote>
<h2 id="Redis集群介绍"><a href="#Redis集群介绍" class="headerlink" title="Redis集群介绍"></a>Redis集群介绍</h2><p>Redis 集群是一个提供<strong>在多个Redis间节点间共享数据</strong>的程序集。</p>
<p>Redis集群并不支持处理多个keys的命令,因为这需要在不同的节点间移动数据,从而达不到像Redis那样的性能,在高负载的情况下可能会导致不可预料的错误.</p>
<p>Redis 集群通过分区来提供<strong>一定程度的可用性</strong>,在实际环境中当某个节点宕机或者不可达的情况下继续处理命令. Redis 集群的优势:</p>
<ul>
<li>自动分割数据到不同的节点上。</li>
<li>整个集群的部分节点失败或者不可达的情况下能够继续处理命令。</li>
</ul>
<h2 id="Redis-集群的数据分片"><a href="#Redis-集群的数据分片" class="headerlink" title="Redis 集群的数据分片"></a>Redis 集群的数据分片</h2><p>Redis 集群没有使用一致性hash, 而是引入了 <strong>哈希槽</strong>的概念.</p>
<p>Redis 集群有16384个哈希槽,每个key通过CRC16校验后对16384取模来决定放置哪个槽.集群的每个节点负责一部分hash槽,举个例子,比如当前集群有3个节点,那么:</p>
<ul>
<li>节点 A 包含 0 到 5500号哈希槽.</li>
<li>节点 B 包含5501 到 11000 号哈希槽.</li>
<li>节点 C 包含11001 到 16384号哈希槽.<blockquote>
<p>这种结构很容易添加或者删除节点. 比如如果我想新添加个节点D, 我需要从节点 A, B, C中得部分槽到D上. 如果我想移除节点A,需要将A中的槽移到B和C节点上,然后将没有任何槽的A节点从集群中移除即可. 由于从一个节点将哈希槽移动到另一个节点并不会停止服务,所以无论添加删除或者改变某个节点的哈希槽的数量都不会造成集群不可用的状态.</p>
</blockquote>
</li>
</ul>
<h2 id="Redis-集群的主从复制模型"><a href="#Redis-集群的主从复制模型" class="headerlink" title="Redis 集群的主从复制模型"></a>Redis 集群的主从复制模型</h2><p>为了使在部分节点失败或者大部分节点无法通信的情况下集群仍然可用，所以集群使用了主从复制模型,每个节点都会有N-1个复制品.</p>
<p>在我们例子中具有A，B，C三个节点的集群,在没有复制模型的情况下,如果节点B失败了，那么整个集群就会以为缺少5501-11000这个范围的槽而不可用.</p>
<p>然而如果在集群创建的时候（或者过一段时间）我们为每个节点添加一个从节点A1，B1，C1,那么整个集群便有三个master节点和三个slave节点组成，这样在节点B失败后，集群便会选举B1为新的主节点继续服务，整个集群便不会因为槽找不到而不可用了</p>
<p>不过当B和B1 都失败后，集群是不可用的.</p>
<h2 id="Redis-一致性保证"><a href="#Redis-一致性保证" class="headerlink" title="Redis 一致性保证"></a>Redis 一致性保证</h2><p>Redis 并不能保证数据的强<strong>一致性</strong>. 这意味这在实际中集群在特定的条件下可能会丢失写操作.</p>
<p>第一个原因是因为集群是用了异步复制. 写操作过程:</p>
<ul>
<li>客户端向主节点B写入一条命令.</li>
<li>主节点B向客户端回复命令状态.</li>
<li>主节点将写操作复制给他得从节点 B1, B2 和 B3.</li>
</ul>
<p>主节点对命令的复制工作发生在返回命令回复之后， 因为如果每次处理命令请求都需要等待复制操作完成的话， 那么主节点处理命令请求的速度将极大地降低 —— 我们必须在性能和一致性之间做出权衡。 注意：Redis 集群可能会在将来提供同步写的方法。 Redis 集群另外一种可能会丢失命令的情况是集群出现了网络分区， 并且一个客户端与至少包括一个主节点在内的少数实例被孤立。</p>
<p>举个例子 假设集群包含 A 、 B 、 C 、 A1 、 B1 、 C1 六个节点， 其中 A 、B 、C 为主节点， A1 、B1 、C1 为A，B，C的从节点， 还有一个客户端 Z1 假设集群中发生网络分区，那么集群可能会分为两方，大部分的一方包含节点 A 、C 、A1 、B1 和 C1 ，小部分的一方则包含节点 B 和客户端 Z1 .</p>
<p>Z1仍然能够向主节点B中写入, 如果网络分区发生时间较短,那么集群将会继续正常运作,如果分区的时间足够让大部分的一方将B1选举为新的master，那么Z1写入B中得数据便丢失了.</p>
<p>注意， 在网络分裂出现期间， 客户端 Z1 可以向主节点 B 发送写命令的最大时间是有限制的， 这一时间限制称为节点超时时间（node timeout）， 是 Redis 集群的一个重要的配置选项：</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Redis-%E9%9B%86%E7%BE%A4%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Redis-%E9%9B%86%E7%BE%A4%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">Redis-集群（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:33:25" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="集群配置文件"><a href="#集群配置文件" class="headerlink" title="集群配置文件"></a>集群配置文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//设置端口号</span><br><span class="line">port 7000</span><br><span class="line">//集群模式</span><br><span class="line">cluster-enabled yes</span><br><span class="line">//保存节点配置文件的路径， 默认值为 nodes.conf.节点配置文件无须人为修改， 它由 Redis 集群在启动时创建， 并在有需要时自动进行更新</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">//节点超时设置</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">// 进程守护</span><br><span class="line">appendonly yes</span><br></pre></td></tr></table></figure>
<h2 id="创建DOcker环境-配置Redis配置"><a href="#创建DOcker环境-配置Redis配置" class="headerlink" title="创建DOcker环境  配置Redis配置"></a>创建DOcker环境  配置Redis配置</h2><h3 id="1、准备redis容器"><a href="#1、准备redis容器" class="headerlink" title="1、准备redis容器"></a>1、准备redis容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name docker-redis-master --mount type=bind,source=/home/leesia/docker/redis/v,target=/leesia redis /bin/bash</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name docker-redis-slave1 --mount type=bind,source=/home/leesia/docker/redis/v,target=/leesia --link docker-redis-master:master redis /bin/bash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>    命令说明：</p>
<blockquote>
<p>    第一条命令是启动主服务容器，容器名为docker-redis-master，mount 参数挂载了宿主机的/home/leesia/docker/redis/v到容器的/leesia目录，宿主机的/home/leesia/docker/redis/v目录必须存在，否则会报错，可以参考–mount参数配置。/bin/bash是容器启动时进入伪终端。</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>    第二条命令是启动从服务容器，容器名为docker-redis-slave1，同样挂载了宿主机的/home/leesia/docker/redis/v到容器的/leesia目录。link参数是连接到其他容器，这里连接到主服务容器docker-redis-master，并设置别名为master。 /bin/bash是容器启动时进入伪终端。</p>
</blockquote>
</blockquote>
<blockquote>
<p>  分别执行这两个命令，可启动redis容器，并进入容器。在容器中按ctrl+p，再ctrl+q可从容器退出，并保持容器继续运行，退出后用执行docker exec -it container_id /bin/bash再次进入容器。</p>
</blockquote>
<p>把定义的配置（两个）文件分别复制到主从容器的/usr/local/bin目录下。<br>分别在主从容器的/usr/local/bin目录下执行redis-server redis.conf命令，启动redis服务。这样，redis主从服务器已经搭建。</p>
<h3 id="2、验证"><a href="#2、验证" class="headerlink" title="2、验证"></a>2、验证</h3><p>在主服务容器的/usr/local/bin目录下执行redis-cli -h 172.17.0.2 -p 6379，连接redis服务，执行set master ‘master’，存入一个master键。</p>
<p>在从服务容器的/usr/local/bin目录下执行redis-cli -h 172.17.0.4 -p 6379，连接redis服务，执行get master，返回’master’，说明主服务器将数据同步到了从服务器中。</p>
<h3 id="代码清单4-2-查看redis结点IP"><a href="#代码清单4-2-查看redis结点IP" class="headerlink" title="代码清单4-2 查看redis结点IP"></a>代码清单4-2 查看redis结点IP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># docker inspect redis01 redis02 redis03 redis04 redis05 redis06 </span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.16&quot;,</span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.17&quot;,</span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.15&quot;,</span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.19&quot;,</span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.14&quot;,</span><br><span class="line"></span><br><span class="line">&quot;IPAddress&quot;: &quot;172.19.0.18&quot;,</span><br></pre></td></tr></table></figure>
<h2 id="安装Redis-集群插件"><a href="#安装Redis-集群插件" class="headerlink" title="安装Redis 集群插件"></a>安装Redis 集群插件</h2><ul>
<li><p>安装插件<br><code>yum install -y redis ruby rubygems</code></p>
</li>
<li><p><code>gem install redis -v 3.2.2</code>  # 由于yum当前默认安装版本为3.2.10，在gem中选择了相近版本3.2.2，<a target="_blank" rel="noopener" href="https://rubygems.org/gems/redis/versions/">更多版本见</a></p>
</li>
<li><p><code>wget http://download.redis.io/redis-stable/src/redis-trib.rb</code> # 下载最新的redis-trib.rb，包含自动将master和slave交叉部署的功能，部分老版本没有该功能*</p>
</li>
<li><p>WARNING: redis-trib.rb is not longer available!这个出现的问题极有可能是 redis-trib.rb与你所安装的版本不符,并不是命令错了，<a target="_blank" rel="noopener" href="https://blog.csdn.net/aaaadong/article/details/82625567">解决办法详情</a> </p>
</li>
<li><p> 直接查找redis版本  <code>redis-server --version</code></p>
</li>
<li><p>windows下载地址 <code>https://github.com/MicrosoftArchive/redis/releases</code></p>
</li>
<li><p>linux下载地址 <code>http://download.redis.io/releases/</code></p>
</li>
<li><p>开放权限<code>chmod +x redis-trib.rb</code></p>
</li>
</ul>
<p>启动集群(条件必须是奇数)  3主3从  高可用配置 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb create --replicas 1 172.17.0.3:6001 172.17.0.4:6002 \</span><br><span class="line">172.17.0.5:6003 172.17.0.6:6004 172.17.0.7:6005 172.17.0.8:6006</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/SpringBoot-%E6%89%93%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/SpringBoot-%E6%89%93%E5%8C%85/" class="post-title-link" itemprop="url">SpringBoot-打包（Jar、war）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:35:26" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="SpringBoot-打包（Jar-、war-）"><a href="#SpringBoot-打包（Jar-、war-）" class="headerlink" title="SpringBoot-打包（Jar-、war-）"></a>SpringBoot-打包（Jar-、war-）</h2><h1 id="War-打包方式"><a href="#War-打包方式" class="headerlink" title="War 打包方式"></a>War 打包方式</h1><h3 id="一-、-没有分模块的maven打包"><a href="#一-、-没有分模块的maven打包" class="headerlink" title="一 、 没有分模块的maven打包"></a>一 、 没有分模块的maven打包</h3><p>1、找到主程序下的<code>pox.xml</code>文件并进行修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>
<p>2、新增Springboot <code>spring-boot-starter-tomcat</code>并将依赖设置为provided。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="二、分模块maven打包"><a href="#二、分模块maven打包" class="headerlink" title="二、分模块maven打包"></a>二、分模块maven打包</h3><p>1、找到主程序下的<code>pox.xml</code>文件并进行修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;warName&gt;api&lt;/warName&gt;</span><br><span class="line">        &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<p>2、 找到 Springboot  <code>spring-boot-starter-web</code>模块排除<code>Tomcat</code>,并新增单独的Springboot <code>Tomcat</code>模块，设置在编译时使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">    &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="以上两种方法都需要继承SpringBootServletInitializer，并且实现其中的方法，在其中指向你应用的主运行类。"><a href="#以上两种方法都需要继承SpringBootServletInitializer，并且实现其中的方法，在其中指向你应用的主运行类。" class="headerlink" title="以上两种方法都需要继承SpringBootServletInitializer，并且实现其中的方法，在其中指向你应用的主运行类。"></a>以上两种方法都需要继承<code>SpringBootServletInitializer</code>，并且实现其中的方法，在其中指向你应用的主运行类。</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class ApplicationRunner extends SpringBootServletInitializer &#123;</span><br><span class="line"> </span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(ApplicationRunner.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) &#123;</span><br><span class="line">        return builder.sources(ApplicationRunner.class);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="JAR"><a href="#JAR" class="headerlink" title="JAR"></a>JAR</h1><h3 id="一-、-没有分模块的maven打包-1"><a href="#一-、-没有分模块的maven打包-1" class="headerlink" title="一 、 没有分模块的maven打包"></a>一 、 没有分模块的maven打包</h3><p>1、找到主程序下的<code>pox.xml</code>文件并进行修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;jar&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

<h3 id="二、分模块maven打包-1"><a href="#二、分模块maven打包-1" class="headerlink" title="二、分模块maven打包"></a>二、分模块maven打包</h3><p>1、找到主程序下的<code>pox.xml</code>文件并进行修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;jar&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;executions&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;repackage&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">    &lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Swagger2-%E6%B3%A8%E8%A7%A3%E8%A7%A3%E9%87%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Swagger2-%E6%B3%A8%E8%A7%A3%E8%A7%A3%E9%87%8A/" class="post-title-link" itemprop="url">Swagger2-注解解释</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:33:45" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="注解的使用方法"><a href="#注解的使用方法" class="headerlink" title="注解的使用方法"></a>注解的使用方法</h2><p>@ApiOperation 用在方法上，说明方法的作用<br>@ApiImplicitParams 用在方法上包含一组方法说明<br>@ApiImplicitParam y用在@ApiImplicitParams 注解中，指明一个请求参数的各个方面</p>
<ul>
<li>paranType 参数放在什么地方</li>
<li>-header 请求参数的获取 @RequestHeader</li>
<li>-query  请求参数的获取 @RequestParam</li>
<li>-path (用于restful接口) 请求参数的获取 @PathVariable （请求后带参数）</li>
<li>-body(RequestBody)</li>
<li>-form (表单提交)</li>
<li>name 参数名称</li>
<li>dataType 参数类型</li>
<li>required 参数是否必传</li>
<li>value 参数的意思</li>
<li>defaultValue 参数默认值</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.mgary.top/2020/05/07/Ubuntu19-%E5%88%86%E8%BE%A8%E7%8E%87%E9%80%89%E9%A1%B9%E4%B8%A2%E5%A4%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MAGRY">
      <meta itemprop="description" content="路其修远兮，吾将上下而求索">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodingDiary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/07/Ubuntu19-%E5%88%86%E8%BE%A8%E7%8E%87%E9%80%89%E9%A1%B9%E4%B8%A2%E5%A4%B1/" class="post-title-link" itemprop="url">Ubuntu19-分辨率选项丢失</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-05-07 12:00:31 / 修改时间：16:33:50" itemprop="dateCreated datePublished" datetime="2020-05-07T12:00:31+08:00">2020-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Ubuntu19-1-分辨率选项丢失"><a href="#Ubuntu19-1-分辨率选项丢失" class="headerlink" title="Ubuntu19-1-分辨率选项丢失"></a>Ubuntu19-1-分辨率选项丢失</h2><hr>
<ul>
<li>方案一<br>直接上手但是这个方法是针对  <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_22999067/article/details/90611457">分辨率调整选项里没有的选项而新增的</a>，因此无效</li>
</ul>
<hr>
<ul>
<li>方案二<ol>
<li>在第一次撞墙后，开始一步一步解决问题，疑点一：显卡驱动是否有误，于是我直接注销使用其他用户登陆<br>发现没有问题，排除显卡驱动问题。</li>
<li>查看调试分辨率命令的帮助文档<code>xrandr  -help</code>最后得出结果，尝试使用下命令直接进行切换才修复成功（有效）<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xrandr -s 0</span><br><span class="line">xrandr -s 1</span><br><span class="line">xrandr -s 2</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">MAGRY</p>
  <div class="site-description" itemprop="description">路其修远兮，吾将上下而求索</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/mgaryc" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;mgaryc" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:a1144362724a@gmail.com" title="E-Mail → mailto:a1144362724a@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">蜀ICP备18037843号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MAGRY</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
